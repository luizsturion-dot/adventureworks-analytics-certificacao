models:
  - name: dim_reasons
    description: "A Degenerate Dimension that aggregates all Sales Reasons and Sales Reason Types associated with a single Sales Order into two concise, delimited strings. This model simplifies analysis of multi-reason orders."
    
    # Materialized as table
    
    columns:
      # --- PRIMARY KEY (Business Key - BK) ---
      - name: salesorder_id
        description: "The primary Business Key (BK) for this dimension, representing the unique Sales Order ID. This column serves as the Foreign Key (FK) when joining back to the FCT_Sales model."
        tests:
          - unique
          - not_null
              
      # --- AGGREGATED ATTRIBUTES ---
      - name: sales_reason_agg
        description: "A comma-separated string listing all distinct Sales Reason names associated with the order (e.g., 'Promotion, Referral, Internet'). Defaults to 'No Reason' if no reason is found."
        tests:
          - not_null
          
      - name: sales_type_agg
        description: "A comma-separated string listing all distinct Sales Reason Types associated with the order (e.g., 'Marketing, Store'). Defaults to 'No Type' if no type is found."
        tests:
          - not_null
          
      # --- AUDIT COLUMN ---
      - name: sales_reason_id
        description: "The Business Key (BK) of the Sales Reason ID. Note: This field is only meaningful if an order has a single reason; otherwise, it should be disregarded in analysis."